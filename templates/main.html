<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task mgm</title>
    <link rel="stylesheet" href="{{url_for('static', filename='css/style.css')}}">
    <link rel="shortcut icon" href="{{ url_for('static', filename='img/taskly_logo.png') }}" type="image/x-icon">

    <script src="{{url_for('static', filename='js/script.js')}}" defer></script>
    <script src="{{url_for('static', filename='js/functions.js')}}"></script>

    <script src="https://unpkg.com/i18next@23.4.6/dist/umd/i18next.min.js"></script>
    <script src="{{url_for('static', filename='js/i18n.js')}}"></script>
</head>
<body>
    <header id="onTop">
        <h3>{{user.coins}}</h3>
        <img src="{{url_for('static', filename='img/money.png')}}" alt="money">
        {% if user.streak > 1 %}
            <div class="streak">
                <img src="{{url_for('static', filename=streak_src)}}" alt="streak" style="width: 32px; height: 32px;">
                <p>{{user.streak}}</p>
            </div>
        {% endif %}
        <nav>    
            <button id="js-toggle-menu">
                <img src="{{url_for('static', filename='img/account.png')}}" alt="account">
            </button>
            <ul id="js-toggleable-menu">
                <li><a href="/account/{{user.name}}" data-i18n="menu.account">Account</a></li>
                <li><a href="/main/{{user.name}}" data-i18n="menu.main">Main Page</a></li>
                <li><a href="https://buycoffee.to/s3qu" data-i18n="menu.buycoffee">Buycoffee</a></li>
                <li><a href="/" data-i18n="menu.out">Log out</a></li>
            </ul>
        </nav>
    </header>
    <section class="main">
        <section>
            <section class="task">
                <header>
                    <h1 data-i18n="main.task.header">Tasks</h1>
                </header>
                <section>
                    <div class="task__list tasks_main">
                        {% if group_reprs or ungrouped_tasks %}
                            {# group representation #}
                            {% for task in group_reprs %}
                                <div class="task__list-card group-card" style="cursor: pointer;">
                                    <h3 class="hover-task">{{ task.name }}</h3>
                                    <p class="hover-desc">{{ task.description }}</p>
                                </div>
                            {% endfor %}
                                
                            {# single tasks #}
                            {% for task in ungrouped_tasks %}
                                <div class="task__list-card group-card" style="cursor: pointer;">
                                    <h3 class="hover-task">{{ task.name }}</h3>
                                    <p class="hover-desc">{{ task.description }}</p>
                                </div>
                            {% endfor %}
                        {% else %}
                            <h2 data-i18n="tasks.notyet">No tasks yet</h2>
                        {% endif %}
                    </div>
                </section>
                <a href="/tasks/{{user.name}}"><button data-i18n="main.task.btn">Manage</button></a>
                <a href="/all_tasks/{{user.name}}" data-i18n="main.task.link">See all your tasks</a>
            </section>
            <section class="pet">
                <img src="{{url_for('static', filename=gif.gif_url)}}" alt="pet" class="pet-gif">
                <img src="{{url_for('static', filename=src)}}" alt="basket" class="pet-basket">
                <h2 id="userName">{{user_pet.name}}</h2>
                <img src="{{url_for('static', filename='img/pencil.png')}}" alt="pen" id="edit" onclick="enableEditing()" class="pet-pen">
                <div class="pet__btn" id="buttons">    
                    <button onclick="resetValue()" class="pet__btn-btn" id="cancel"><img src="{{url_for('static', filename='img/cancel.png')}}" alt="cancel"></button>
                    <form action="{{url_for('update_name', user=user.name, pet_id=user_pet.id)}}" method="post">
                        <input type="hidden" name="new_name" id="hiddenName">
                        <button class="pet__btn-btn" id="confirm">
                            <img src="{{url_for('static', filename='img/check.png')}}" alt="confirm">
                        </button>
                    </form>
                </div>
                <progress value="{{user_pet.feed}}" max="100"></progress>
                <form action="{{url_for('increase_feed', user=user.name, user_coins=user.coins, pet_id=user_pet.id)}}" method="post">
                    <button><span data-i18n="main.pet.feed">FEED</span><span>20</span></button>
                </form>
            </section>
            <section class="shop">
                <header>
                    <h1 data-i18n="main.shop.header">SHOP</h1>
                </header>
                <section class="shop__options">
                    <h3 data-i18n="main.shop.h3">Buy new pet</h3>
                    <section class="shop__options-pets">
                        <figure>
                            <img src="{{url_for('static', filename='img/pet/panda.png')}}" alt="pet1">
                        </figure>
                        <figure data-i18n-attr="data-diag:main.shop.diag">
                            <img src="{{url_for('static', filename='img/pet/kitty.png')}}" alt="pet2">
                        </figure>
                        <figure data-i18n-attr="data-diag:main.shop.diag">
                            <img src="{{url_for('static', filename='img/pet/animal.png')}}" alt="pet3">
                        </figure>
                    </section>
                    <h3 id="special" data-i18n="main.shop.special">Buy perks</h3>
                    <section class="shop__options-perks">
                        {% if user.coins >= 70 %}
                            <figure style="cursor: pointer;">
                        {% else %}
                            <figure style="filter: grayscale(80%);">
                        {% endif %}
                            {% if user.coins >= 70 %}
                                <a href="/potka/{{user.name}}">
                            {% endif %}
                            <img src="{{url_for('static', filename='img/poisonous.png')}}" alt="heal">
                            {% if user.coins >= 70 %}
                                </a>
                            {% endif %}
                            <div class="desc">
                                <h4 data-i18n="main.shop.desc.potka.h4">Instant health</h4>
                                <p data-i18n="main.shop.desc.potka.p">This item will add 45 feed points</p>
                                <div>
                                    <h5 data-i18n="main.shop.desc.cost">Cost</h5>
                                    <p>70</p>
                                </div>
                            </div>
                        </figure>
                        {% if user.coins >= 110 %}
                            <figure style="cursor: pointer;">
                        {% else %}
                            <figure style="filter: grayscale(80%);">
                        {% endif %}
                            {% if user.coins >= 110 %}
                                <a href="/streak_return/{{user.name}}">
                            {% endif %}
                            <img src="{{url_for('static', filename='img/fire.png')}}" alt="fire">
                            {% if user.coins >= 110 %}
                                </a>
                            {% endif %}
                            <div class="desc">
                                <h4 data-i18n="main.shop.desc.streak.h4">Streak return</h4>
                                <p data-i18n="main.shop.desc.streak.p">If you forgot make one task per day and lost your strak. You can buy it and resume your streak</p>
                                <div>
                                    <h5 data-i18n="main.shop.desc.cost">Cost</h5>
                                    <p>110</p>
                                </div>
                            </div>
                        </figure>
                        {% if user.coins >= 90 %}
                            <figure style="cursor: pointer;">
                        {% else %}
                            <figure style="filter: grayscale(80%);">
                        {% endif %}
                            {% if user.coins >= 90 %}
                                <a href="/apple/{{user.name}}">
                            {% endif %}
                            <img src="{{url_for('static', filename='img/apple.png')}}" alt="apple">
                            {% if user.coins >= 90 %}
                                </a>
                            {% endif %}
                            <div class="desc">
                                <h4 data-i18n="main.shop.desc.apple.h4">Golden apple</h4>
                                <p data-i18n="main.shop.desc.apple.p">This item gives full feed</p>
                                <div>
                                    <h5 data-i18n="main.shop.desc.cost">Cost</h5>
                                    <p>90</p>
                                </div>
                            </div>
                        </figure>
                        {% if user.coins >= 175 %}
                            <figure style="cursor: pointer;">
                        {% else %}
                            <figure style="filter: grayscale(80%);">
                        {% endif %}
                            {% if user.coins >= 175 %}
                                <a href="/god_hand/{{user.name}}">
                            {% endif %}
                            <img src="{{url_for('static', filename='img/zeus.png')}}" alt="hand">
                            {% if user.coins >= 175 %}
                                </a>
                            {% endif %}
                            <div class="desc">
                                <h4 data-i18n="main.shop.desc.hand.h4">God hand</h4>
                                <p data-i18n="main.shop.desc.hand.p">God hand gives full feed and resume your streak</p>
                                <div>
                                    <h5 data-i18n="main.shop.desc.cost">Cost</h5>
                                    <p>175</p>
                                </div>
                            </div>
                        </figure>
                    </section>
                    <h3 id="special" data-i18n="main.shop.delete">Buy delete</h3>
                    <p data-i18n="main.shop.ddesc">You can delete every task you want, but you have to pay 40 coins</p>
                    <section class="shop__options-delete">
                        <form action="{{url_for('delete', user=user.name)}}" method="POST">
                            <select name="delete" id="">
                                <option selected disabled hidden data-i18n="main.task.header">Task</option>
                                {% if group_reprs or ungrouped_tasks %}
                                    {% for task in group_reprs %}
                                        <option value="{{ task.id }}">{{ task.name }} | {{ task.repeatability }}</option>
                                        {% endfor %}
                                    {% for task in ungrouped_tasks %}
                                        <option value="{{ task.id }}">{{ task.name }} | {{ task.repeatability }}</option>
                                    {% endfor %}
                                {% endif %}
                            </select>
                            <button type="submit"><span data-i18n="main.shop.btn">DELETE</span><span>40</span></button>
                        </form>
                    </section>
                </section>
            </section>
        </section>
    </section>
</body>
</html>